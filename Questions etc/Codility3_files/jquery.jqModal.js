!function(n){"object"==typeof module&&"object"==typeof module.exports?module.exports=n(require("jquery")):n(jQuery)}((function(n){n.fn.jqm=function(t){return this.each((function(){var o=n(this).data("jqm")||n.extend({ID:c++},n.jqm.params),e=n.extend(o,t);n(this).data("jqm",e).addClass("jqm-init")[0]._jqmID=e.ID,n(this).jqmAddTrigger(e.trigger)}))},n.fn.jqmAddTrigger=function(o){if(o)return this.each((function(){i(n(this),"jqmShow",o)||t("jqmAddTrigger must be called on initialized modals")}))},n.fn.jqmAddClose=function(o){if(o)return this.each((function(){i(n(this),"jqmHide",o)||t("jqmAddClose must be called on initialized modals")}))},n.fn.jqmShow=function(t){return this.each((function(){this._jqmShown||o(n(this),t)}))},n.fn.jqmHide=function(t){return this.each((function(){this._jqmShown&&e(n(this),t)}))};var t=function(n){window.console&&window.console.error&&window.console.error(n)},o=function(t,o){o=o||window.event;var e=t.data("jqm"),i=parseInt(t.css("z-index"))||3e3,a=n("<div></div>").addClass(e.overlayClass).css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":i-1,opacity:e.overlay/100}),r={w:t,c:e,o:a,t:o};if(t.css("z-index",i),e.ajax){var d=e.target||t,c=e.ajax;d="string"==typeof d?n(d,t):n(d),"@"===c.substr(0,1)&&(c=n(o).attr(c.substring(1))),d.load(c,(function(){e.onLoad&&e.onLoad.call(this,r)})),e.ajaxText&&d.html(e.ajaxText),s(r)}else s(r)},e=function(n,t){t=t||window.event;var o=n.data("jqm"),e={w:n,c:o,o:n.data("jqmv"),t};a(e)},i=function(t,o,e){var i=t.data("jqm");if(i)return n(e).each((function(){this[o]=this[o]||[],n.inArray(i.ID,this[o])<0&&(this[o].push(i.ID),n(this).click((function(n){return n.isDefaultPrevented()||t[o](this),!1})))}))},s=function(t){var o=t.w,e=t.o,i=t.c;!1!==i.onShow(t)&&(o[0]._jqmShown=!0,i.modal?(u[0]||r("bind"),u.push(o[0])):o.jqmAddClose(e),i.closeClass&&o.jqmAddClose(n("."+i.closeClass,o)),i.toTop&&e&&o.before('<span id="jqmP'+i.ID+'"></span>').insertAfter(e),o.data("jqmv",e),o.unbind("keydown",n.jqm.closeOnEscFunc),i.closeOnEsc&&o.attr("tabindex",0).bind("keydown",n.jqm.closeOnEscFunc).focus())},a=function(t){var o=t.w,e=t.o,i=t.c;!1!==i.onHide(t)&&(o[0]._jqmShown=!1,i.modal&&(u.pop(),u[0]||r("unbind")),i.toTop&&e&&n("#jqmP"+i.ID).after(o).remove())},r=function(t){n(document)[t]("keypress keydown mousedown",d)},d=function(t){var o=n(t.target).data("jqm")||n(t.target).parents(".jqm-init:first").data("jqm"),e=u[u.length-1];return!(!o||o.ID!==e._jqmID)||n.jqm.focusFunc(e,t)},c=0,u=[];return n.jqm={params:{overlay:50,overlayClass:"jqmOverlay",closeClass:"jqmClose",closeOnEsc:!1,trigger:".jqModal",ajax:!1,target:!1,ajaxText:"",modal:!1,toTop:!1,onShow:function(t){return t.c.overlay>0&&t.o.prependTo("body"),t.w.show(),n.jqm.focusFunc(t.w,!0),!0},onHide:function(n){return n.w.hide()&&n.o&&n.o.remove(),!0},onLoad:!1},focusFunc:function(t,o){return o&&n(":input:visible:first",t).focus(),!1},closeOnEscFunc:function(t){if(27===t.keyCode)return n(this).jqmHide(),!1}},n.jqm}));